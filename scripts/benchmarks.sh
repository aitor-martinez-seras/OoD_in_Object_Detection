nohup python ood_evaluation.py --benchmark logits_methods --which_split train --load_ind_activations --ood_datasets owod coco_ood coco_mixed --ood_method MSP --which_internal_activations logits --device 1 --ind_info_creation_option valid_preds_one_stride --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_logits1.log 2>&1 &
nohup python ood_evaluation.py --benchmark logits_methods --which_split val --load_ind_activations --ood_datasets owod coco_ood coco_mixed --ood_method MSP --which_internal_activations logits --device 2 --ind_info_creation_option valid_preds_one_stride --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_logits2.log 2>&1 &
nohup python ood_evaluation.py --benchmark logits_methods --which_split train_val --load_ind_activations --ood_datasets owod coco_ood coco_mixed --ood_method MSP --which_internal_activations logits --device 0 --ind_info_creation_option valid_preds_one_stride --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_logits3.log 2>&1 &

# Cluster methods (silhouette - calinski_harabasz)
nohup python ood_evaluation.py --which_split train_val --benchmark cluster_methods --load_ind_activations --ood_datasets coco_ood coco_mixed --ood_method CosineIvis --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_cluster_methods_Cosine_IVIS.log 2>&1 &
nohup python ood_evaluation.py --which_split train_val --benchmark cluster_methods --load_ind_activations --remove_orphans --ood_datasets coco_ood coco_mixed --ood_method Cosine_cl_stride --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_cluster_methods_Cosine.log 2>&1 &
nohup python ood_evaluation.py --which_split train_val --benchmark cluster_methods --load_ind_activations --remove_orphans --ood_datasets coco_ood coco_mixed --ood_method L1_cl_stride --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_cluster_methods_L1.log 2>&1 &
nohup python ood_evaluation.py --which_split train_val --benchmark cluster_methods --load_ind_activations --remove_orphans --ood_datasets coco_ood coco_mixed --ood_method L2_cl_stride --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_cluster_methods_L2.log 2>&1 &

# CLuster IVIS
nohup python ood_evaluation.py --ood_method L1Ivis --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --benchmark cluster_methods --ood_datasets coco_ood coco_mixed owod --ood_split val --owod_task_ood t1 --ind_info_creation_option valid_preds_one_stride --which_split train_val --load_ind_activations --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 > logs/benchmark_cluster_methods_L2Ivis.log 2>&1 &
nohup python ood_evaluation.py --ood_method L2Ivis --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --benchmark cluster_methods --ood_datasets coco_ood coco_mixed owod --ood_split val --owod_task_ood t1 --ind_info_creation_option valid_preds_one_stride --which_split train_val --load_ind_activations --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 > logs/benchmark_cluster_methods_L2Ivis.log 2>&1 &
nohup python ood_evaluation.py --ood_method CosineIvis --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --benchmark cluster_methods --ood_datasets coco_ood coco_mixed owod --ood_split val --owod_task_ood t1 --ind_info_creation_option valid_preds_one_stride --which_split train_val --load_ind_activations --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 > logs/benchmark_cluster_methods_CosineIvis.log 2>&1 &

# Conf train
nohup python ood_evaluation.py --which_split train_val --benchmark conf_thr_train --load_ind_activations --ood_datasets owod coco_ood coco_mixed --ood_method Cosine_cl_stride --cluster_method one --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 2 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_train_Cosine.log 2>&1 &

# Conf test 'MSP', 'Energy', 'ODIN',
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method MSP --cluster_method one --which_internal_activations logits --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_MSP.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method Energy --cluster_method one --which_internal_activations logits --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_Energy.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method ODIN --cluster_method one --which_internal_activations logits --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_ODIN.log 2>&1 &

nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L1_cl_stride --cluster_method one --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L1_one.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L1_cl_stride --cluster_method KMeans --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L1_KMeans.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L1_cl_stride --cluster_method KMeans_10 --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L1_KMeans_10.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L1_cl_stride --cluster_method HDBSCAN --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L1_HDBSCAN.log 2>&1 &

nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L2_cl_stride --cluster_method one --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L2_one.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L2_cl_stride --cluster_method KMeans --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L2_KMeans.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L2_cl_stride --cluster_method KMeans_10 --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L2_KMeans_10.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method L2_cl_stride --cluster_method HDBSCAN --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_L2_HDBSCAN.log 2>&1 &

nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method Cosine_cl_stride --cluster_method one --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_Cosine_one.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method Cosine_cl_stride --cluster_method KMeans --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_Cosine_KMeans.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method Cosine_cl_stride --cluster_method KMeans_10 --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_Cosine_KMeans_10.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method Cosine_cl_stride --cluster_method HDBSCAN --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_Cosine_HDBSCAN.log 2>&1 &

nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method CosineIvis --cluster_method one --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_CosineIvis_KMeans.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method CosineIvis --cluster_method KMeans --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_CosineIvis_KMeans.log 2>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method CosineIvis --cluster_method KMeans_10 --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_CosineIvis_KMeans_10.log 2>>&1 &
nohup python ood_evaluation.py --benchmark conf_thr_test --ood_method CosineIvis --cluster_method HDBSCAN --which_internal_activations ftmaps_and_strides --which_split train_val  --load_ind_activations --ood_datasets owod coco_ood coco_mixed --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_conf_trest_CosineIvis_HDBSCAN.log 2>&1 &

# Fusion
nohup python ood_evaluation.py --which_split train_val --ood_method Cosine_cl_stride --cluster_method HDBSCAN-KMeans_10 --benchmark fusion_strategies --load_ind_activations --ood_datasets owod coco_ood coco_mixed --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_fusion.log 2>&1 &
nohup python ood_evaluation.py --which_split train_val --ood_method Cosine_cl_stride --cluster_method KMeans_10-HDBSCAN --benchmark fusion_strategies --load_ind_activations --ood_datasets owod coco_ood coco_mixed --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_fusion.log 2>&1 &
# UNK
nohup python ood_evaluation.py --which_split train_val --ood_method Cosine_cl_stride  --cluster_method HDBSCAN --benchmark unk_loc_enhancement --load_ind_activations --ood_datasets coco_ood coco_mixed --ood_method Cosine_cl_stride --which_internal_activations ftmaps_and_strides --cluster_optimization_metric silhouette --device 0 --ind_info_creation_option valid_preds_one_stride  --conf_thr_train 0.15 --conf_thr_test 0.15 --tpr_thr 0.95 --model_path runs_OWOD/20240313_1407_owod_t1_yolov8l_from_scratch/weights/best.pt --ind_dataset owod --ind_split train --owod_task_ind t1 --ood_split val --owod_task_ood t1 > logs/benchmark_UNK.log 2>&1 &


